!function(a){var b=function(){var b='<span style="font-size:12px;font-weight:bold;text-align:center">'+Highcharts.dateFormat("%b %d, %Y",this.x)+"</span>";return a.each(this.points,function(){"line"==this.series.type&&(b+="<br/>"+this.y+' : <span style="color:'+this.color+'">'+this.series.name+"</span>")}),b},c={area_threshold:-999,callbacks:{},chart:null,chart_anchor:"#csftool-display-chart",chart_labels:{},chart_type:null,chart_config:{chart:{type:"area"},plotOptions:{series:{states:{hover:{enabled:!0,halo:!1}}}},credits:{text:"Powered by NRCC",href:"http://www.nrcc.cornell.edu/",color:"#000000"},title:{text:"Grape Hardiness @ T50"},subtitle:{text:"location address",style:{"font-size":"14px",color:"#000000"}},xAxis:{type:"datetime",crosshair:{width:1,color:"#ff0000",snap:!0},labels:{style:{color:"#000000"}},dateTimeLabelFormats:{millisecond:"%H:%M:%S.%L",second:"%H:%M:%S",minute:"%H:%M",hour:"%H:%M",day:"%d %b",week:"%d %b",month:"%b<br/>%Y",year:"%Y"},crosshair:{width:1,color:"#ff0000",snap:!0,zIndex:10}},yAxis:{title:{text:"Temperature",style:{"font-size":"14px",color:"#000000"}},gridZIndex:4,labels:{style:{color:"#000000"}}},tooltip:{useHtml:!0,shared:!0,borderColor:"#000000",borderWidth:2,borderRadius:8,shadow:!1,backgroundColor:"#ffffff",style:{width:165},xDateFormat:"%b %d, %Y",positioner:function(){return{x:80,y:60}},formatter:b},legend:{floating:!0,backgroundColor:"#ffffff",borderRadius:5,borderWidth:1,align:"left",verticalAlign:"top",x:70,y:50,width:165,zIndex:20},series:[]},components:{hardarea:{name:"T50 Damage Potential",type:"area",zIndex:2,lineWidth:0,color:"#ffb3b3",marker:{enabled:!1,states:{hover:{enabled:!1}}}},hardfcast:{name:"Hardiness Forecast",type:"line",zIndex:12,lineWidth:0,color:"#00cc00",marker:{enabled:!0,fillColor:"#00cc00",lineWidth:0,lineColor:"#00cc00",radius:3,symbol:"circle"}},hardtemp:{name:"Hardiness Temp",type:"line",zIndex:11,lineWidth:2,color:"#00cc00",marker:{enabled:!0,fillColor:"#00cc00",lineWidth:1,lineColor:"#00cc00",radius:3,symbol:"circle"}},mintarea:{name:"No Damage Potential",type:"area",zIndex:3,lineWidth:0,color:"#ffffff",fillOpacity:1,showInLegend:!1,marker:{enabled:!1,states:{hover:{enabled:!1}}}},mintemp:{name:"Min Temperature",type:"line",zIndex:13,lineWidth:2,color:"#0000ff",marker:{enabled:!1}},minfcast:{name:"Min Temp Forecast",type:"line",zIndex:14,lineWidth:0,color:"#0000ff",marker:{enabled:!1}}},data:{},default_chart:null,display_anchor:null,dom:'<div id="csftool-display-chart"></div>',drawn:[],event_types:["drawing_complete","series_drawn"],initialized:!1,location:null,required:["hardtemp","mintemp"],season:null,tool:null,variety:null,varieties:null,view:null,highchartsIsAvailable:function(){return"undefined"!=typeof Highcharts},addSeries:function(b,c){if(c&&c.length>1){null!=this.chart&&"undefined"!=typeof this.chart||this.newChart();var d=a.extend(!0,{id:b,data:c},this.components[b]);"hardarea"!=b&&"mintarea"!=b||(d.threshold=this.area_threshold),this.validChart(),this.drawn.indexOf(b)>-1&&this.remove(b),this.chart.addSeries(d,!0),this.drawn.indexOf(b)<0&&this.drawn.push(b),this.execCallback("series_drawn",b)}this.complete()},allDrawn:function(){var b=!0,d=this;return a.each(this.required,function(a,c){d.drawn.indexOf(c)<0&&(b=!1)}),b},bind:function(a,b){this.event_types.indexOf(a)>0&&(this.callbacks[a]=b)},clear:function(){for(;this.chart.series.length>0;)this.chart.series[0].remove(!1);this.drawn=[]},chartHeight:function(a){this.chart_config.chart.height=a},chartLabel:function(a,b){this.chart_labels[a]=b},chartLabels:function(b){this.chart_labels=a.extend(this.chart_labels,b)},chartType:function(a){this.chart_type=a},chartWidth:function(a){this.chart_config.chart.width=a},complete:function(a){this.allDrawn()&&this.execCallback("drawing_complete")},dataExtremes:function(a){var b,c,d=-999,e=999;for(b=0;b<a.length;b++)c=a[b][1],c>d&&(d=c),c<e&&(e=c);return[e,d]},draw:function(){this.tool.logObjectAttrs(this.view);var a=this.tool.fullview("mint",this.view),b=this.dataExtremes(a),c=b[0],d=this.tool.fullview("hardtemp",this.view);b=this.dataExtremes(d),c<b[0]&&(this.area_threshold=c-5,this.addSeries("mintarea",a),this.addSeries("hardarea",d)),this.addSeries("hardtemp",this.tool.observed("hardtemp",this.view)),this.addSeries("hardfcast",this.tool.forecast("hardtemp",this.view)),this.addSeries("mintemp",this.tool.observed("mint",this.view)),this.addSeries("minfcast",this.tool.forecast("mint",this.view))},drawChartLabel:function(){var a=this.season+" "+this.chart_labels[this.chart_type];this.chart.renderer.text(a,325,85).css({color:"#000000",fontSize:"16px"}).add()},execCallback:function(b,c){var d=this.callbacks[b];d&&(c?d(b,[c,a.extend([],this.drawn)]):d(b,a.extend([],this.drawn)))},init:function(b){this.display_anchor="#"+b.id,a(this.display_anchor).append(this.dom),Highcharts.setOptions({global:{useUTC:!1}}),this.initialized=!0,null==this.chart_type&&(this.chart_type=this.default_chart)},locationChange:function(a){null!=this.location&&a.address==this.location||(this.location=a.address),"variety"in a&&this.varietyChange(a.variety)},newChart:function(){null!=this.chart&&(this.chart.destroy(),this.chart=null);var b=a.extend(!0,{},this.chart_config);b.series=[],b.title.text=this.title(),b.subtitle.text=this.subtitle(),a(this.chart_anchor).highcharts("Chart",b),this.chart=a(this.chart_anchor).highcharts(),this.drawChartLabel(),this.drawn=[]},redraw:function(){this.newChart(),this.draw()},refresh:function(){this.clear(),this.draw()},remove:function(a){if(null!=this.chart)if("undefined"!=typeof a){var b,c=this.components[a].name,d=this.chart.series.length;for(b=0;b<d;b++)if(this.chart.series[b].name==c){this.chart.series[b].remove();break}}else this.chart.destroy(),this.chart=null},resetExtremes:function(){this.yaxis_max=-999,this.yaxis_min=999},setOption:function(a,b){switch(a){case"chart":case"chart_type":this.chartType(b);break;case"default":this.default_chart=b;break;case"height":this.chartHeight(b);break;case"labels":this.chartLabels(b);break;case"location":this.locationChange(b);break;case"season":this.season=b;break;case"variety":this.varietyChange(b);break;case"varieties":this.varieties=b;break;case"view":this.setView(b);break;case"width":this.chartWidth(b)}},setOptions:function(b){a.each(b,function(a){var d=b[a];for(var e in d)c.setOption(e,d[e])})},setView:function(b){this.view=a.extend({},b)},subtitle:function(){return"@ "+this.location},title:function(){return this.varieties[this.variety]+" T50 Hardiness Temperature"},validChart:function(){null===this.chart&&this.newChart()},varietyChange:function(a){null==this.variety?this.variety=a:a!=this.variety&&(this.variety=a)}},d=function(){if(1==arguments.length)switch(arguments[0]){case"chart":case"chart_type":return c.chart_type;case"chart_anchor":return c.chart_anchor;case"display_anchor":return c.display_anchor;case"draw":c.draw();break;case"drawn":return c.drawn;case"location":return c.location;case"newChart":c.newChart();break;case"redraw":c.redraw();break;case"refresh":c.refresh();break;case"season":return c.season;case"start_date":return c.start_date;case"variety":return c.variety;case"view":return c.view}else if(2==arguments.length){var a=arguments[0],b=arguments[1];switch(a){case"options":c.setOptions(b);break;default:c.setOption(a,b)}}else"option"==arguments[0]?c.setOption(arguments[1],arguments[2]):"bind"==arguments[0]&&c.bind(arguments[1],arguments[2])};a.fn.GrapeHardinessChart=function(b,e){var f=this.get(0);return c.tool=b,"undefined"!==a.type(e)&&a.each(e,function(a,b){d.apply(d,b)}),c.init(f),[c,d]}}(jQuery);